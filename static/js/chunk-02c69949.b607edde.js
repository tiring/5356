(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02c69949"],{"0d5d":function(t,a,e){},1353:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.isShowTableField?e("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{"header-align":"center",align:"center",width:"100px",type:"index",label:"序号"}}),t._v(" "),t._l(t.filterTableField.data,(function(a,i){return e("el-table-column",{key:i,attrs:{prop:a[0],label:a[1],"min-width":a[2],"show-overflow-tooltip":!0,"header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return["text"==a[3]?e("el-input",{staticStyle:{border:"1px solid #ccc"},attrs:{disabled:t.isDisabled},on:{input:function(e){("temporaryNumbering"==a[0]||"totalRegistrationMark"==a[0])&&t.changeValue(i.row[a[0]],i.$index)}},model:{value:i.row[a[0]],callback:function(e){t.$set(i.row,a[0],e)},expression:"scoped.row[item[0]]"}}):e("span",[t._v(t._s(i.row[a[0]]))])]}}],null,!0)})})),t._v(" "),e("el-table-column",{attrs:{"header-align":"center",align:"center",fixed:"right",width:"100",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{disabled:t.isDisabled,type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.deleteRow(a)}}})]}}],null,!1,2257387212)})],2):t._e(),t._v(" "),e("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[e("el-radio",{attrs:{disabled:t.isDisabled,label:"2"},on:{change:t.getRadio},model:{value:t.radio,callback:function(a){t.radio=a},expression:"radio"}},[t._v("正式账清单")]),t._v(" "),e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{disabled:t.isDisabled,size:"small"},on:{click:t.addOneLine}},[t._v("添加一行")])],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{disabled:t.isDisabled,size:"small"},on:{click:function(a){t.isShowAddInput=!0}}},[t._v("添加多行")]),t._v(" "),t.isShowAddInput?e("el-input",{staticStyle:{"margin-top":"10px",width:"100px"},attrs:{size:"small"},model:{value:t.number,callback:function(a){t.number=t._n(a)},expression:"number"}}):t._e(),t._v(" "),t.isShowAddInput?e("el-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"small"},on:{click:t.addMoreLine}},[t._v("确定")]):t._e()],1)],1)],1)},n=[],o=(e("7f7f"),e("4431")),s={props:{sentType:{type:String,default:"2"},defaultData:{type:Array},isDisabled:{type:Boolean,default:!1}},data:function(){return{radio:this.sentType,tableField:{},serveTableField:{},collTableField:{},filterTableField:{data:[]},isShowTableField:!1,tableData:[],number:null,isShowAddInput:!1,addNewLine:{},collLine:{temporaryNumbering:"",name:"",offer:"",quantity:"",recruitTime:""},serveLine:{totalRegistrationMark:"",name:"",originalName:"",gradeEvaluation:"",censusName:"",age:"",inventoryState:""},ids:[]}},computed:{},created:function(){this.fatchData()},methods:{getRadio:function(t){this.tableData=[],this.ids=[],"2"==this.radio?(this.tableField=this.serveTableField,this.addNewLine=this.serveLine):"1"==this.radio&&(this.addNewLine=this.collLine,this.tableField=this.collTableField),this.getTableField()},changeValue:function(t,a){var e=this;if(""===t)return!0;"1"==this.radio?Object(o["W"])(t).then((function(i){i.data?(e.ids[a]=i.data.id,e.$set(e.tableData[a],"temporaryNumbering",i.data.temporaryNumbering),e.$set(e.tableData[a],"name",i.data.name),e.$set(e.tableData[a],"offer",i.data.offer),e.$set(e.tableData[a],"quantity",i.data.quantity),e.$set(e.tableData[a],"recruitTime",i.data.recruitTime)):(e.ids[a]="",e.$set(e.tableData[a],"temporaryNumbering",t),e.$set(e.tableData[a],"name",""),e.$set(e.tableData[a],"offer",""),e.$set(e.tableData[a],"quantity",""),e.$set(e.tableData[a],"recruitTime",""))})):"2"==this.radio&&Object(o["Rb"])(t).then((function(i){i.data?(e.ids[a]=i.data.id,e.$set(e.tableData[a],"totalRegistrationMark",i.data.totalRegistrationMark),e.$set(e.tableData[a],"name",i.data.name),e.$set(e.tableData[a],"originalName",i.data.originalName),e.$set(e.tableData[a],"gradeEvaluation",i.data.gradeEvaluation?data.gradeEvaluation.name:""),e.$set(e.tableData[a],"censusName",i.data.censusName),e.$set(e.tableData[a],"age",i.data.age),e.$set(e.tableData[a],"inventoryState",i.data.inventoryState)):(console.log("mei zhidao"),e.ids[a]="",e.$set(e.tableData[a],"totalRegistrationMark",t),e.$set(e.tableData[a],"name",""),e.$set(e.tableData[a],"originalName",""),e.$set(e.tableData[a],"gradeEvaluation",""),e.$set(e.tableData[a],"censusName",""),e.$set(e.tableData[a],"age",""),e.$set(e.tableData[a],"inventoryState",""))}))},getRulesData:function(){var t,a=this;return 0==this.tableData.length?{data:!1,msg:"表格中没有数据"}:("1"==this.radio?this.tableData.some((function(e,i){if(""==e.temporaryNumbering||""==e.name)return t={data:!1,msg:"表格中第"+(i+1)+"项的征集编号没有找到数据,或者有征集编号未填"},!0;var n=!1;if(a.tableData.some((function(a,i){if(e.temporaryNumbering==a.temporaryNumbering)return n=!0,t={data:!1,msg:"表格中第"+e+"项和第"+a+"项数据重复"},!0})),n)return!0;a.tableData.length-1==i&&(t={data:!0,msg:"验证通过"})})):"2"==this.radio&&this.tableData.some((function(e,i){if(""==e.totalRegistrationMark||""==e.name)return t={data:!1,msg:"表格中第"+(i+1)+"项的总登记号没有找到数据,或者有总登记号未填"},!0;console.log(a.tableData);var n=!1;if(a.tableData.some((function(a,o){if(e.totalRegistrationMark==a.totalRegistrationMark&&o!==i)return console.log(a),n=!0,t={data:!1,msg:"表格中第"+(i+1)+"项和第"+(o+1)+"项数据重复"},!0})),n)return!0;a.tableData.length-1==i&&(t={data:!0,msg:"验证通过"})})),console.log(t,4545),t)},addOneLine:function(){this.tableData.push(JSON.parse(JSON.stringify(this.addNewLine))),this.ids.push("")},deleteRow:function(t,a){this.tableData.splice(t.$index,1),this.ids.splice(t.$index,1)},addMoreLine:function(){if(this.number>10)this.$message.error("最多一次性只可添加10条");else{for(var t=0;t<this.number;t++)this.tableData.push(JSON.parse(JSON.stringify(this.addNewLine)));this.number=null,this.isShowAddInput=!1}},fatchData:function(){var t=this;Object(o["V"])().then((function(a){t.collTableField=a.data,"1"==t.radio&&(t.isShowTableField=!0,t.tableField=t.collTableField,t.getTableField(),t.addNewLine=t.collLine)})),Object(o["Uc"])().then((function(a){t.serveTableField=a.data,"2"==t.radio&&(t.tableField=t.serveTableField,t.isShowTableField=!0,t.getTableField(),t.addNewLine=t.serveLine)}))},getTableField:function(){var t={data:[]},a=this.tableField;this.isShowTableField&&("1"==this.radio?(t.data[0]=a.temporaryNumbering,t.data[0].push("150","text"),t.data[1]=a.name,t.data[1].push("100","span"),t.data[2]=a.offer,t.data[2].push("100","span"),t.data[3]=a.quantity,t.data[3].push("100","span"),t.data[4]=a.recruitTime,t.data[4].push("100","span")):"2"==this.radio&&(t.data[0]=a.totalRegistrationMark,t.data[0].push("150","text"),t.data[1]=a.name,t.data[1].push("200","span"),t.data[2]=a.originalName,t.data[2].push("200","span"),t.data[3]=a.gradeEvaluation,t.data[3].push("100","span"),t.data[4]=a.censusName,t.data[4].push("200","span"),t.data[5]=a.age,t.data[5].push("100","span"),t.data[6]=a.inventoryState,t.data[6].push("80","span"))),this.$set(this.filterTableField,"data",t.data),this.filterTableField.data=t.data}},watch:{sentType:{handler:function(t){this.radio=t,this.$emit("getInventoryTableData",this.ids,this.tableData,this.radio)}},defaultData:{handler:function(t){var a=this;this.tableData=[],this.ids=[],""==t.length?(this.tableData=[],this.ids=[]):"1"==this.radio?t.map((function(t){var e=t;a.ids.push(e.id),a.tableData.push({temporaryNumbering:e.temporaryNumbering,name:e.name,offer:e.offer,quantity:e.quantity,recruitTime:e.recruitTime})})):"2"==this.radio&&t.map((function(t){var e=t;a.ids.push(e.id),a.tableData.push({totalRegistrationMark:e.totalRegistrationMark,name:e.name,originalName:e.originalName,gradeEvaluation:e.gradeEvaluation?e.gradeEvaluation.name:"",censusName:e.censusName,age:e.age,inventoryState:e.inventoryState})}))},deep:!0},tableData:{handler:function(t){this.$emit("getInventoryTableData",this.ids,this.tableData,this.radio)},deep:!0}}},l=s,r=(e("5ef8"),e("2877")),d=Object(r["a"])(l,i,n,!1,null,"282801ec",null);a["a"]=d.exports},"27fa":function(t,a,e){"use strict";var i=e("0d5d"),n=e.n(i);n.a},"456d":function(t,a,e){var i=e("4bf8"),n=e("0d58");e("5eda")("keys",(function(){return function(t){return n(i(t))}}))},"5eda":function(t,a,e){var i=e("5ca1"),n=e("8378"),o=e("79e5");t.exports=function(t,a){var e=(n.Object||{})[t]||Object[t],s={};s[t]=a(e),i(i.S+i.F*o((function(){e(1)})),"Object",s)}},"5ef8":function(t,a,e){"use strict";var i=e("71fd"),n=e.n(i);n.a},"71fd":function(t,a,e){},"8b8c":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"audit_record"},[t.isShowAuditRecordTimeButton?e("ConditionShow",{attrs:{sentconditiondatas:t.getAuditRecordTimeButtons},on:{changecondition:t.getTimeData}}):t._e(),t._v(" "),t.isShowInventorySearchField?e("SearchCondition",{attrs:{sentAttconditiondatas:t.getInventorySearchField},on:{changeAttcondition:t.getSearchDatas}}):t._e(),t._v(" "),e("div",{staticClass:"divBox"},[e("div",{staticStyle:{padding:"10px 0"}},[e("TableTopButton",{attrs:{sentBatchOperationDatas:t.batchOperationDatas},on:{changeChildDailogShow:t.getChildDailogShow}})],1),t._v(" "),t.isShowTableField&&t.isShowTableList?e("TableList",{attrs:{sentTableFields:t.getTableField,sentTableData:t.filterTableList},on:{changePagination:t.getChildPagination,changeChildDailogShow:t.getChildDailogShow,getTableID:t.getTableChildID}}):t._e()],1),t._v(" "),e("article",[t.isShowDialog.onInventory||t.isShowDialog.onName?e("PropBox",{attrs:{sentdialogVisible:t.isShowDialog.onInventory||t.isShowDialog.onName},on:{saveData:t.saveInventoryData,changeDiagdialogShow:t.getDiagdialogShow},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("清单管理")]},proxy:!0},{key:"article",fn:function(){return[e("ul",[e("li",{attrs:{title:"清单属性"}},[e("InventoryForm",{ref:"inventoryForm",attrs:{isDisabled:t.isDisabled,sentFormData:t.newFormData},on:{getFormData:t.getFormData}})],1),t._v(" "),e("li",[e("InventoryTable",{ref:"inventoryTable",attrs:{sentType:t.inventoryType,defaultData:t.inventoryTableData},on:{getInventoryTableData:t.getInventoryTableData}})],1)])]},proxy:!0},{key:"confirm",fn:function(){return[t._v("保存")]},proxy:!0}],null,!1,482095995)}):t._e()],1)],1)},n=[],o=e("db72"),s=(e("7f7f"),e("f972")),l=e("3897"),r=e("86f5"),d=e("80fb"),c=e("d921"),h=e("1353"),u=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form_box"},[e("p",{staticClass:"form_title"},[t._v("清单属性")]),t._v(" "),e("div",{staticClass:"form_content"},[e("el-form",{ref:"form",attrs:{size:"small",model:t.formData,"label-width":"100px"}},[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"w33 fl"},[e("el-form-item",{attrs:{rules:{required:!0,message:"清单名称不能为空",trigger:"blur"},prop:"name",label:"清单名称"}},[e("el-input",{model:{value:t.formData.name,callback:function(a){t.$set(t.formData,"name",a)},expression:"formData.name"}})],1)],1),t._v(" "),e("div",{staticClass:"w33 fl"},[e("el-form-item",{attrs:{prop:"memo",label:"清单用途"}},[e("el-input",{model:{value:t.formData.memo,callback:function(a){t.$set(t.formData,"memo",a)},expression:"formData.memo"}})],1)],1),t._v(" "),t.isDisabled?e("div",{staticClass:"w33 fl"},[e("el-form-item",{attrs:{prop:"created",label:"创建时间"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:"",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期"},model:{value:t.created,callback:function(a){t.created=a},expression:"created"}})],1)],1):t._e()])])],1)])},m=[],b=(e("ac6a"),e("456d"),{props:{sentFormData:{type:Object,default:function(){return{}}},isDisabled:{type:Boolean,default:!1}},data:function(){return{formField:{name:["name","清单名称"],memo:["memo","备注"]},created:"",formData:{name:"",memo:""}}},watch:{formData:{handler:function(t){this.$emit("getFormData",t)},deep:!0},sentFormData:{handler:function(t){0==Object.keys(t).length?(this.formData.name="",this.memo=""):(this.formData.name=t.name,this.formData.memo=t.memo,this.created=t.created)},deep:!0}},created:function(){this.fatchData()},methods:{getRulesData:function(){var t=!1;return this.$refs.form.validate((function(a){t=a})),{msg:t?"表单验证通过":"请检查输入的表单是否有误",data:t}},resetRules:function(){this.$refs.form.resetFields()},fatchData:function(){}}}),f=b,g=e("2877"),p=Object(g["a"])(f,u,m,!1,null,null,null),D=p.exports,v=e("5308"),y=e("8593"),S={components:{SearchCondition:s["a"],ConditionShow:l["a"],TableList:r["a"],TableTopButton:d["a"],PropBox:c["a"],InventoryTable:h["a"],InventoryForm:D},data:function(){return{isDisabled:!1,isShowAuditRecordTimeButton:!0,auditRecordTimeButton:{0:["0","今天"],1:["1","昨天"],2:["2","本周"],3:["3","上周"],4:["4","本月"],5:["5","上月"],createdEnd:["createdEnd","结束时间"],createdSta:["createdSta","起始时间"],leadRegistrationTime:["leadRegistrationTime","入藏时间"]},isShowInventorySearchField:!1,inventorySearchField:{},isShowTableField:!1,isShowTableList:!1,tableField:{},tableList:{},timeData:{},searchData:{},paginationData:{},batchOperationDatas:{left:[{name:"新建清单",eventName:"onInventory"}],right:[]},dialogShow:{onInventory:!1,onName:!1},isShowDialog:{},getChildDailogShowVal:"",tableRowId:"",formData:{},newFormData:{},tableData:[],radio:"",inventoryType:"2",inventoryTableData:[],typeCode:{1:"征集清单",2:"正式账清单"}}},computed:{getInventorySearchField:function(){var t,a=this.inventorySearchField;return t=[{type:"text",labelName:"查询属性",key:"queryAttr"},{type:"text",labelName:a.name[1],key:a.name[0]},{type:"select",labelName:a.type[1],key:a.type[0],data:"constValue",items:[{key:"1",name:"征集清单"},{key:"2",name:"正式账清单"}]},{type:"text",labelName:a.information[1],key:a.information[0]}],t},getAuditRecordTimeButtons:function(){var t,a=this.auditRecordTimeButton,e=[];return this.isShowAuditRecordTimeButton&&(t={title:a.leadRegistrationTime[1],fieldName:a.leadRegistrationTime[0],dataType:"regdate",createdSta:a.createdSta[0],createdEnd:a.createdEnd[0],showed:!0,iconDef:!1,iconShow:!1,dataPicker:!0,items:[{name:a[0][1],fieldName:a[0][0],active:!0,num:0,id:"2-1"},{name:a[1][1],fieldName:a[1][0],active:!1,num:0,id:"2-2"},{name:a[2][1],fieldName:a[2][0],active:!1,num:0,id:"2-3"},{name:a[3][1],fieldName:a[3][0],active:!1,num:0,id:"2-4"},{name:a[4][1],fieldName:a[4][0],active:!1,num:0,id:"2-5"},{name:a[5][1],fieldName:a[5][0],active:!1,num:0,id:"2-6"}]},e.push(t)),e},getTableField:function(){var t={data:[],button:[]},a=this.tableField;return this.isShowTableField&&(t.data[0]=a.name,t.data[0].push("100","center",{eventName:"onName"}),t.data[1]=a.type,t.data[1].push("100","center"),t.data[2]=a.information,t.data[2].push("100","center"),t.data[3]=a.created,t.data[3].push("100","center")),t.button.push({name:"征集登记",eventName:"onColl"}),t.button.push({name:"账目修改",eventName:"onAccounts"}),t.button.push({name:"出库申请",eventName:"onOutStoreInv"}),t.button.push({name:"出库确认",eventName:"onOutStoreConfig"}),t.button.push({name:"归库确认",eventName:"onInStoreConfig"}),t.button.push({name:"事故登记",eventName:"onAccidentReg"}),t.button.push({name:"修复登记",eventName:"onRepairReg"}),t.button.push({name:"消毒任务",eventName:"onDisinfectTask"}),t},getSearchData:function(){var t=Object(o["a"])({page:0,size:10},this.timeData,{},this.searchData);return t},allSearchData:function(){var t=Object(o["a"])({},this.timeData,{},this.searchData,{},this.paginationData);return t},filterTableList:function(){var t=this,a=this.tableList;return a.content.map((function(a){a.type=t.typeCode[a.type]})),a}},watch:{getChildDailogShowVal:{handler:function(){switch(this.getChildDailogShowVal){case"onInventory":this.isShowDialog.onInventory=!0;break;case"onName":this.isShowDialog.onName=!0;break;default:this.isShowDialog.onInventory=!1,this.isShowDialog.onName=!1}},immediate:!0}},created:function(){this.fatchData(),this.isShowDialog=JSON.parse(JSON.stringify(this.dialogShow))},methods:{saveInventoryData:function(){var t=this,a=Object(v["a"])("YUANZHIHUI"),e=JSON.parse(a).id,i=Object(o["a"])({itemList:JSON.stringify(this.tableData)},this.formData,{type:this.inventoryType,userInfoId:e}),n=this.$refs.inventoryForm.getRulesData(),s=this.$refs.inventoryTable.getRulesData();n.data&&s.data?"onName"==this.getChildDailogShowVal?Object(y["fb"])(Object(o["a"])({},i,{personalListId:this.tableRowId})).then((function(a){t.$message({type:"success",message:a.msg}),t.getChildDailogShowVal="",t.init(t.getSearchData)})):"onInventory"==this.getChildDailogShowVal&&Object(y["fb"])(i).then((function(a){t.$message({type:"success",message:a.msg}),t.getChildDailogShowVal="",t.init(t.getSearchData)})):n.data?s.data||this.$message({type:"error",message:s.msg}):this.$message({type:"error",message:n.msg})},getTableChildID:function(t,a){console.log(a),this.tableRowId=t,"征集清单"==a.type?this.inventoryType="1":"正式账清单"==a.type&&(this.inventoryType="2")},getInventoryTableData:function(t,a,e){var i=this;console.log(t,a,e,789),this.inventoryType=e,this.tableData=[],t.map((function(t,a){i.tableData.push({targetId:t})}))},getFormData:function(t){this.formData=t},getDiagdialogShow:function(){this.getChildDailogShowVal="",this.tableRowId=""},changeName:function(){var t=this;Object(y["E"])(this.tableRowId).then((function(a){t.newFormData=a.data;var e=[];t.radio=a.data.type,a.data.personalListItemList.map((function(t){e.push(Object(o["a"])({},t.target))})),t.inventoryTableData=e}))},getChildDailogShow:function(t){switch(this.getChildDailogShowVal=t,this.getChildDailogShowVal){case"onInventory":this.newFormData={},this.isDisabled=!1;break;case"onName":this.changeName(),this.isDisabled=!0;break}},getChildPagination:function(t){this.paginationData=t,this.init(this.allSearchData)},getTimeData:function(t){this.timeData=t,this.init(this.getSearchData)},getSearchDatas:function(t){this.searchData=t,this.init(this.getSearchData)},fatchData:function(){var t=this;Object(y["F"])().then((function(a){t.inventorySearchField=a.data,t.isShowInventorySearchField=!0})),Object(y["G"])().then((function(a){t.isShowTableField=!0,t.tableField=a.data}))},init:function(t){var a=this;console.log("55555"),this.isShowTableList=!1,Object(y["H"])(t).then((function(t){a.isShowTableList=!0,a.tableList=t.data}))}}},w=S,T=(e("27fa"),Object(g["a"])(w,i,n,!1,null,"94df800c",null));a["default"]=T.exports}}]);