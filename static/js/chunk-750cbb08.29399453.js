(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-750cbb08"],{"456d":function(e,t,a){var i=a("4bf8"),o=a("0d58");a("5eda")("keys",(function(){return function(e){return o(i(e))}}))},"504c":function(e,t,a){var i=a("9e1e"),o=a("0d58"),n=a("6821"),s=a("52a7").f;e.exports=function(e){return function(t){var a,l=n(t),r=o(l),c=r.length,h=0,d=[];while(c>h)a=r[h++],i&&!s.call(l,a)||d.push(e?[a,l[a]]:l[a]);return d}}},"5eda":function(e,t,a){var i=a("5ca1"),o=a("8378"),n=a("79e5");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],s={};s[e]=t(a),i(i.S+i.F*n((function(){a(1)})),"Object",s)}},8615:function(e,t,a){var i=a("5ca1"),o=a("504c")(!1);i(i.S,"Object",{values:function(e){return o(e)}})},cfc6:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"check_task",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e.isShowCheckTaskTimeButton&&e.isShowCheckTaskStateButton?a("conditionShow",{attrs:{sentconditiondatas:e.getCheckTaskButtons},on:{changecondition:e.getButtonData}}):e._e(),e._v(" "),e.isShowCheckTaskSearchField?a("SearchCondition",{attrs:{sentAttconditiondatas:e.getCheckTaskSearchFields},on:{changeAttcondition:e.getSearchData}}):e._e(),e._v(" "),a("div",{staticClass:"divBox"},[a("div",{staticStyle:{padding:"10px 0"}},[a("TableTopButton",{attrs:{sentBatchOperationDatas:e.batchOperationDatas},on:{changeChildDailogShow:e.getChildDailogShow}})],1),e._v(" "),e.isShowCheckTaskTableField&&e.isShowCheckTaskTableList?a("TableList",{ref:"table",attrs:{sentTableFields:e.getTableField,sentTableData:e.filterTableList},on:{changePagination:e.getChildPagination,changeChildDailogShow:e.getChildDailogShow,getTableID:e.getTableChildID,getSelectIDs:e.getSelectChildIDsDatas}}):e._e()],1),e._v(" "),a("article",[e.isShowDialog.onBatchAbnormal?a("PropBox",{attrs:{sentdialogVisible:e.isShowDialog.onBatchAbnormal},on:{saveData:e.batchSubmit,changeDiagdialogShow:e.getDiagdialogShow},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("批量异常")]},proxy:!0},{key:"article",fn:function(){return[a("ul",[a("li",{attrs:{title:"异常登记"}},[a("CollBatchCheckForm",{ref:"checkForm",attrs:{sentFormData:e.newFormData,sentCodes:e.codes},on:{getFormData:e.getFormData}})],1)])]},proxy:!0},{key:"confirm",fn:function(){return[e._v("提交")]},proxy:!0}],null,!1,2393428160)}):e._e(),e._v(" "),e.isShowDialog.onAbnormal?a("PropBox",{attrs:{sentdialogVisible:e.isShowDialog.onAbnormal},on:{saveData:e.saveCollAbnormal,changeDiagdialogShow:e.getDiagdialogShow},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("异常登记")]},proxy:!0},{key:"article",fn:function(){return[a("ul",[a("li",{attrs:{title:"基础信息"}},[e.isShowTableRowData?a("PropBaseMessage",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1),e._v(" "),a("li",{attrs:{title:"基础信息"}},[e.isShowTableRowData?a("PropBaseAttribute",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1),e._v(" "),a("li",{attrs:{title:"保管信息"}},[e.isShowTableRowData?a("PropSafekeepingInformation",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1),e._v(" "),a("li",{attrs:{title:"异常登记"}},[a("CollBatchCheckForm",{ref:"collCheckForm",attrs:{sentFormData:e.newFormData},on:{getFormData:e.getFormData}})],1)])]},proxy:!0},{key:"confirm",fn:function(){return[e._v("提交")]},proxy:!0}],null,!1,1815679553)}):e._e(),e._v(" "),e.isShowDialog.onCollName?a("PropBox",{attrs:{sentdialogVisible:e.isShowDialog.onCollName},on:{changeDiagdialogShow:e.getDiagdialogShow},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("藏品信息")]},proxy:!0},{key:"article",fn:function(){return[a("ul",[a("li",{attrs:{title:"基础信息"}},[e.isShowTableRowData?a("PropBaseMessage",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1),e._v(" "),a("li",{attrs:{title:"基础信息"}},[e.isShowTableRowData?a("PropBaseAttribute",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1),e._v(" "),a("li",{attrs:{title:"保管信息"}},[e.isShowTableRowData?a("PropSafekeepingInformation",{attrs:{sentSelectTableListData:e.tableRowData}}):e._e()],1)])]},proxy:!0}],null,!1,1679172937)}):e._e()],1)],1)},o=[],n=a("db72"),s=(a("7f7f"),a("3897")),l=a("bb89"),r=a("86f5"),c=a("80fb"),h=a("d921"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isShowFormField?a("div",{staticClass:"form_box"},[a("p",{staticClass:"form_title"},[e._v("异常登记")]),e._v(" "),a("div",{staticClass:"form_content"},[a("el-form",{ref:"form",attrs:{model:e.formData,size:"small","label-width":"100px"}},[a("div",{staticClass:"clearfix"},[0!=e.sentCodes.length?a("div",{staticClass:"fl w100"},[a("el-form-item",{attrs:{label:e.formField.warehouseCheckIds[1]}},[a("el-input",{attrs:{disabled:""},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"fl w50"},[a("el-form-item",{attrs:{rules:{required:!0,message:"盘点时间不能为空",trigger:"blur"},prop:e.formField.checkTime[0],label:e.formField.checkTime[1]}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.formData.checkTime,callback:function(t){e.$set(e.formData,"checkTime",t)},expression:"formData.checkTime"}})],1)],1),e._v(" "),a("div",{staticClass:"fl w50"},[a("el-form-item",{attrs:{rules:{required:!0,message:"盘点人不能为空",trigger:"blur"},prop:e.formField.proposerNameId[0],label:e.formField.proposerNameId[1]}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.proposerNameId,callback:function(t){e.$set(e.formData,"proposerNameId",t)},expression:"formData.proposerNameId"}},e._l(e.userList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e._v(" "),a("div",{staticClass:"fl w100"},[a("el-form-item",{attrs:{rules:{required:!0,message:"异常描述不能为空",trigger:"blur"},prop:e.formField.exception[0],label:e.formField.exception[1]}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.formData.exception,callback:function(t){e.$set(e.formData,"exception",t)},expression:"formData.exception"}})],1)],1)])])],1)]):e._e()},m=[],u=(a("ac6a"),a("456d"),a("4431")),g=a("8593"),f={props:{sentCodes:{type:Array,default:function(){return[]}},sentFormData:{type:Object,default:function(){return{}}}},data:function(){return{userList:[],formField:{},isShowFormField:!1,formData:{proposerNameId:"",checkTime:"",exception:""},newFormData:{},code:this.sentCodes.join(",")}},watch:{formData:{handler:function(e){this.$emit("getFormData",e)},deep:!0},sentFormData:{handler:function(e){0==Object.keys(e).legnth?this.formData=this.newFormData:(console.log(e),this.formData.checkTime=e.checkTime,this.formData.proposerNameId=e.proposerNameId,this.formData.exception=e.exception)},deep:!0}},created:function(){this.fatchData(),this.newFormData=JSON.parse(JSON.stringify(this.formData))},methods:{getRulesData:function(){var e=!1;return this.$refs.form.validate((function(t){e=t})),{msg:e?"表单验证通过":"请检查输入的表单是否有误",data:e}},resetRules:function(){this.$refs.form.resetFields()},fatchData:function(){var e=this;Object(u["Pd"])().then((function(t){e.formField=t.data,e.isShowFormField=!0})),Object(g["U"])().then((function(t){e.userList=t.data}))}}},b=f,D=a("2877"),k=Object(D["a"])(b,d,m,!1,null,null,null),p=k.exports,w=a("fa10"),S=a("a153"),T=a("5a62"),v={components:{conditionShow:s["a"],SearchCondition:l["a"],TableList:r["a"],TableTopButton:c["a"],PropBox:h["a"],CollBatchCheckForm:p,PropBaseMessage:w["a"],PropBaseAttribute:S["a"],PropSafekeepingInformation:T["a"]},data:function(){return{listLoading:!0,isShowCheckTaskTimeButton:!1,checkTaskTimeButton:{},isShowCheckTaskStateButton:!1,checkTaskStateButton:{},isShowCheckTaskSearchField:!1,checkTaskSearchField:{},isShowCheckTaskTableField:!1,isShowCheckTaskTableList:!1,checkTaskTableField:{},checkTaskTableList:[],InventoryStateData:[{name:"在库",key:"0"},{name:"提借中",key:"1"},{name:"恶劣",key:"2"}],checkStateCode:{0:"待开始",1:"正常",2:"异常"},buttonData:{},searchData:{},paginationData:{},batchOperationDatas:{left:[{name:"批量正常",eventName:"onBatchNormal"},{name:"批量异常",eventName:"onBatchAbnormal"},{name:"返回地图",eventName:"onBack"}],right:[{name:"原表格导出",eventName:"onExport"}]},getChildDailogShowVal:"",tableRowId:"",tableRowIds:[],isShowDialog:{},dialogShow:{onCollName:!1,onNormal:!1,onAbnormal:!1,onBatchAbnormal:!1},codes:[],formData:{},newFormData:{},id:this.$route.query.taskId||"",encodingsId:this.$route.query.encodingsId||"",warehouseInfoId:this.$route.query.warehouseInfoId||"",isShowTableRowData:!1,tableRowData:{data:{}}}},computed:{getCheckTaskButtons:function(){var e,t,a=this.checkTaskTimeButton,i=this.checkTaskStateButton,o=[];return this.isShowCheckTaskStateButton&&(e={title:i.checkState[1],fieldName:i.checkState[0],dataType:"button",showed:!0,iconDef:!0,iconShow:!0,items:[{name:i[0][1],fieldName:i[0][0],active:!0,num:0,id:"1-1"},{name:i[1][1],fieldName:i[1][0],active:!1,num:0,id:"1-2"},{name:i[2][1],fieldName:i[2][0],active:!1,num:0,id:"1-3"}]},o.push(e)),this.isShowCheckTaskTimeButton&&(t={title:a.checkTime[1],fieldName:a.checkTime[0],createdSta:a.createdSta[0],createdEnd:a.createdEnd[0],dataType:"regdate",showed:!0,iconDef:!0,dataPicker:!0,iconShow:!1,items:[{name:a[0][1],fieldName:a[0][0],active:!0,num:0,id:"2-1"},{name:a[1][1],fieldName:a[1][0],active:!1,num:0,id:"2-2"},{name:a[2][1],fieldName:a[2][0],active:!1,num:0,id:"2-3"},{name:a[3][1],fieldName:a[3][0],active:!1,num:0,id:"2-4"},{name:a[4][1],fieldName:a[4][0],active:!1,num:0,id:"2-5"},{name:a[5][1],fieldName:a[5][0],active:!1,num:0,id:"2-6"}]},o.push(t)),o},getCheckTaskSearchFields:function(){var e=this.checkTaskSearchField,t=[];return this.isShowCheckTaskSearchField&&(t=[{type:"text",labelName:e.queryAttr[1],key:e.queryAttr[0]},{type:"text",labelName:e.totalRegistrationMark[1],key:e.totalRegistrationMark[0]},{type:"select",labelName:e.type[1],key:e.type[0],data:"server",items:{optionType:4}},{type:"select",labelName:e.warehouseId[1],key:e.warehouseId[0],data:"server",value:this.warehouseInfoId,items:{optionType:201}},{type:"select",labelName:e.encodingsId[1],key:e.encodingsId[0],data:"server",value:this.encodingsId,items:{optionType:202,warehouseId:this.warehouseInfoId}},{type:"select",labelName:e.gradeEvaluation[1],key:e.gradeEvaluation[0],data:"server",items:{optionType:8}},{type:"select",labelName:e.degreeDisability[1],key:e.degreeDisability[0],data:"server",items:{optionType:6}},{type:"select",labelName:e.InventoryState[1],key:e.InventoryState[0],data:"constValue",items:this.InventoryStateData}]),t},getTableField:function(){var e={data:[],button:[]},t=this.checkTaskTableField;return e.data[0]=t.name,e.data[0].push("150","center",{eventName:"onCollName"}),e.data[1]=t.totalRegistrationMark,e.data[1].push("100","center"),e.data[2]=t.gradeEvaluation,e.data[2].push("100","center"),e.data[3]=t.type,e.data[3].push("100","center"),e.data[4]=t.warehouseId,e.data[4].push("100","center"),e.data[5]=t.checkState,e.data[5].push("100","center"),e.button.push({name:"正常",eventName:"onNormal"}),e.button.push({name:"异常",eventName:"onAbnormal"}),e},getPaginationData:function(){this.id||this.$router.go(-1);var e=Object(n["a"])({page:0,size:10,encodingsId:this.encodingsId,taskId:this.id},this.searchData,{},this.buttonData);return e},allSearchData:function(){var e=Object(n["a"])({encodingsId:this.encodingsId,taskId:this.id},this.buttonData,{},this.searchData,{},this.paginationData);return e},filterTableList:function(){var e=this,t=this.checkTaskTableList;return t.content.map((function(t){t.totalRegistrationMark=t.collectionDetail.totalRegistrationMark,t.collectionDetail.type&&(t.type=t.collectionDetail.type.name),t.name=t.collectionDetail.name,t.collectionDetail.warehouseInfo&&(t.warehouseId=t.collectionDetail.warehouseInfo.name),t.collectionDetail.gradeEvaluation&&(t.gradeEvaluation=t.collectionDetail.gradeEvaluation.name),t.collectionImages=t.collectionDetail.collectionDetailImages,t.checkState=e.checkStateCode[t.checkState]})),t}},watch:{getChildDailogShowVal:{handler:function(e){switch(this.getChildDailogShowVal){case"onBatchAbnormal":this.isShowDialog.onBatchAbnormal=!0;break;case"onAbnormal":this.isShowDialog.onAbnormal=!0;break;case"onCollName":this.isShowDialog.onCollName=!0;break;default:this.isShowDialog.onAbnormal=!1,this.isShowDialog.onBatchAbnormal=!1,this.isShowDialog.onCollName=!1}},immediate:!0}},created:function(){this.fatchData(),this.isShowDialog=JSON.parse(JSON.stringify(this.dialogShow))},methods:{saveCollAbnormal:function(){var e=this,t=this.$refs.collCheckForm.getRulesData();t.data?Object(u["Ee"])(Object(n["a"])({id:this.tableRowId},this.formData)).then((function(t){e.$refs.table.clearGetSelectLise(),e.init(e.allSearchData),e.$message({type:"success",message:t.msg}),e.getChildDailogShowVal=""})):this.$message({type:"error",message:t.msg})},getFormData:function(e){this.formData=e},batchSubmit:function(){var e=this,t=this.PMethods.ArrayToString(this.tableRowIds),a=Object(n["a"])({},this.formData,{warehouseCheckIds:t}),i=this.$refs.checkForm.getRulesData();i.data?Object(u["Fe"])(a).then((function(t){e.init(e.allSearchData),e.$refs.table.clearGetSelectLise(),e.$message({type:"success",message:t.msg}),e.getChildDailogShowVal="",e.codes=[]})):this.$message({type:"error",message:i.msg})},getDiagdialogShow:function(){this.getChildDailogShowVal="",this.tableRowId=""},getTableChildID:function(e){this.tableRowId=e},getSelectChildIDsDatas:function(e,t){var a=this;this.tableRowIds=e,this.codes=[],t.map((function(e){a.codes.push(e.collectionDetail.classificationNumber)}))},batchNormal:function(){var e=this;if(this.tableRowIds,this.tableRowIds.length>0){var t=this.PMethods.ArrayToString(this.tableRowIds);this.$confirm("藏品批量正常登记!","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["Ge"])(t).then((function(t){e.$message({type:"success",message:t.msg}),e.$refs.table.clearGetSelectLise(),e.init(e.allSearchData),e.getChildDailogShowVal=""}))})).catch((function(){e.getChildDailogShowVal="",e.$message({type:"info",message:"已取消"})}))}else this.$message({type:"info",message:"请至少选择一项"})},normal:function(){var e=this;this.$confirm("该数据是否正常?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["He"])(e.tableRowId).then((function(t){e.$message({type:"success",message:t.msg}),e.init(e.allSearchData),e.getChildDailogShowVal="",e.$refs.table.clearGetSelectLise()}))})).catch((function(){e.getChildDailogShowVal="",e.$message({type:"info",message:"已取消"})}))},abnormal:function(){var e=this;Object(u["Od"])(this.tableRowId).then((function(t){e.isShowTableRowData=!0,e.tableRowData.data=t.data.collectionDetail,e.newFormData=t.data}))},getTaskCheckData:function(){var e=this;Object(u["M"])(this.id).then((function(t){e.newFormData=t.data}))},getChildDailogShow:function(e){switch(this.getChildDailogShowVal=e,this.getChildDailogShowVal){case"onBack":this.$router.push({path:"/collection/dailymanagement/store",query:{taskId:this.id}});break;case"onBatchNormal":this.batchNormal();break;case"onNormal":this.normal();break;case"onAbnormal":this.abnormal();break;case"onBatchAbnormal":this.tableRowIds.length>0?this.getTaskCheckData():(this.getChildDailogShowVal="",this.$message({type:"info",message:"请至少选择一项"}));break;case"onCollName":this.abnormal();break}},getButtonData:function(e){this.buttonData=e,this.init(this.getPaginationData)},getSearchData:function(e){console.log(e),e?this.searchData=e:(this.$set(this.searchData,"encodingsId",""),this.$set(this.searchData,"warehouseInfoId","")),this.init(this.getPaginationData)},getChildPagination:function(e){this.paginationData=e,this.init(this.allSearchData)},fatchData:function(){var e=this;Object(u["O"])().then((function(t){e.checkTaskStateButton=t.data,e.isShowCheckTaskStateButton=!0})),Object(u["R"])().then((function(t){e.checkTaskTimeButton=t.data,e.isShowCheckTaskTimeButton=!0})),Object(u["N"])().then((function(t){e.checkTaskSearchField=t.data,e.isShowCheckTaskSearchField=!0})),Object(u["P"])().then((function(t){e.checkTaskTableField=t.data,e.isShowCheckTaskTableField=!0}))},init:function(e){var t=this;this.listLoading=!0,Object(u["Q"])(e).then((function(e){t.isShowCheckTaskTableList=!0,t.checkTaskTableList=e.data,t.listLoading=!1}))}}},y=v,C=Object(D["a"])(y,i,o,!1,null,null,null);t["default"]=C.exports}}]);